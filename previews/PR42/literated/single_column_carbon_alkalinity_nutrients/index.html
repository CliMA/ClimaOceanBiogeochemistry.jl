<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Single column carbon, alkalinity, nutrients · ClimaOceanBiogeochemistry.jl</title><meta name="title" content="Single column carbon, alkalinity, nutrients · ClimaOceanBiogeochemistry.jl"/><meta property="og:title" content="Single column carbon, alkalinity, nutrients · ClimaOceanBiogeochemistry.jl"/><meta property="twitter:title" content="Single column carbon, alkalinity, nutrients · ClimaOceanBiogeochemistry.jl"/><meta name="description" content="Documentation for ClimaOceanBiogeochemistry.jl."/><meta property="og:description" content="Documentation for ClimaOceanBiogeochemistry.jl."/><meta property="twitter:description" content="Documentation for ClimaOceanBiogeochemistry.jl."/><meta property="og:url" content="https://clima.github.io/ClimaOceanBiogeochemistry.jl/dev/literated/single_column_carbon_alkalinity_nutrients/"/><meta property="twitter:url" content="https://clima.github.io/ClimaOceanBiogeochemistry.jl/dev/literated/single_column_carbon_alkalinity_nutrients/"/><link rel="canonical" href="https://clima.github.io/ClimaOceanBiogeochemistry.jl/dev/literated/single_column_carbon_alkalinity_nutrients/"/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">ClimaOceanBiogeochemistry.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../single_column_nutrients_plankton_bacteria_detritus/">Single column nutrients, plankton, bacteria, detritus</a></li><li class="is-active"><a class="tocitem" href>Single column carbon, alkalinity, nutrients</a><ul class="internal"><li><a class="tocitem" href="#A-single-column-grid"><span>A single column grid</span></a></li><li><a class="tocitem" href="#Buoyancy-that-depends-on-temperature-and-salinity"><span>Buoyancy that depends on temperature and salinity</span></a></li><li><a class="tocitem" href="#Boundary-conditions"><span>Boundary conditions</span></a></li><li><a class="tocitem" href="#We-put-the-pieces-together"><span>We put the pieces together</span></a></li><li><a class="tocitem" href="#Initial-conditions"><span>Initial conditions</span></a></li><li><a class="tocitem" href="#A-simulation-of-physical-biological-interaction"><span>A simulation of physical-biological interaction</span></a></li><li><a class="tocitem" href="#Run-the-example"><span>Run the example</span></a></li><li><a class="tocitem" href="#Visualization"><span>Visualization</span></a></li></ul></li><li><a class="tocitem" href="../soda_outgassing/">Soda outgassing</a></li><li><a class="tocitem" href="../simple_plankton_growth_death/">Simple plankton growth and death</a></li></ul></li><li><span class="tocitem">Library</span><ul><li><a class="tocitem" href="../../library/outline/">Contents</a></li><li><a class="tocitem" href="../../library/public/">Public</a></li><li><a class="tocitem" href="../../library/internals/">Private</a></li><li><a class="tocitem" href="../../library/function_index/">Function index</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href>Single column carbon, alkalinity, nutrients</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Single column carbon, alkalinity, nutrients</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/CliMA/ClimaOceanBiogeochemistry.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/CliMA/ClimaOceanBiogeochemistry.jl/blob/main/examples/single_column_carbon_alkalinity_nutrients.jl" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Simple-carbon-cycle-biogeochemistry-model"><a class="docs-heading-anchor" href="#Simple-carbon-cycle-biogeochemistry-model">Simple carbon cycle biogeochemistry model</a><a id="Simple-carbon-cycle-biogeochemistry-model-1"></a><a class="docs-heading-anchor-permalink" href="#Simple-carbon-cycle-biogeochemistry-model" title="Permalink"></a></h1><p>This example illustrates how to use ClimaOceanBiogeochemistry&#39;s <code>CarbonAlkalinityNutrients</code> model in a single column context.</p><pre><code class="language-julia hljs">using ClimaOceanBiogeochemistry: CarbonAlkalinityNutrients
using ClimaOceanBiogeochemistry.CarbonSystemSolvers.UniversalRobustCarbonSolver: UniversalRobustCarbonSystem
using ClimaOceanBiogeochemistry.CarbonSystemSolvers: CarbonSystemParameters, CarbonSolverParameters, CarbonCoefficientParameters

using Oceananigans
using Oceananigans.Units
using Oceananigans.TurbulenceClosures: CATKEVerticalDiffusivity

using Adapt
using KernelAbstractions: @kernel, @index
using Oceananigans.Utils: launch!
using Printf
using CairoMakie

arch = CPU()</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Oceananigans.Architectures.CPU()</code></pre><h2 id="A-single-column-grid"><a class="docs-heading-anchor" href="#A-single-column-grid">A single column grid</a><a id="A-single-column-grid-1"></a><a class="docs-heading-anchor-permalink" href="#A-single-column-grid" title="Permalink"></a></h2><p>We set up a single column grid with 4 m grid spacing that&#39;s 256 m deep:</p><pre><code class="language-julia hljs">grid = RectilinearGrid(
    arch,
    size = 512,
    z = (-4096, 0),
    topology = (
        Flat, Flat, Bounded
     ),
)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">1×1×512 RectilinearGrid{Float64, Oceananigans.Grids.Flat, Oceananigans.Grids.Flat, Oceananigans.Grids.Bounded} on Oceananigans.Architectures.CPU with 0×0×3 halo
├── Flat x
├── Flat y
└── Bounded  z ∈ [-4096.0, 0.0]   regularly spaced with Δz=8.0</code></pre><h2 id="Buoyancy-that-depends-on-temperature-and-salinity"><a class="docs-heading-anchor" href="#Buoyancy-that-depends-on-temperature-and-salinity">Buoyancy that depends on temperature and salinity</a><a id="Buoyancy-that-depends-on-temperature-and-salinity-1"></a><a class="docs-heading-anchor-permalink" href="#Buoyancy-that-depends-on-temperature-and-salinity" title="Permalink"></a></h2><p>We use the <code>SeawaterBuoyancy</code> model with a linear equation of state, where thermal expansion</p><pre><code class="language-julia hljs">αᵀ = 2e-4
#and haline contraction
βˢ = 8e-4</code></pre><h2 id="Boundary-conditions"><a class="docs-heading-anchor" href="#Boundary-conditions">Boundary conditions</a><a id="Boundary-conditions-1"></a><a class="docs-heading-anchor-permalink" href="#Boundary-conditions" title="Permalink"></a></h2><p>We calculate the surface temperature flux associated with surface cooling of 200 W m⁻², reference density <code>ρₒ</code>, and heat capacity <code>cᴾ</code>, To illustrate the dynamics of <code>CarbonAlkalinityNutrients</code>, this strong convection drives turbulent mixing for 4 days, and then abruptly shuts off. Once the convective turbulence dies down, plankton start to grow.</p><pre><code class="language-julia hljs">Qʰ = 200.0  # W m⁻², surface _heat_ flux
ρₒ = 1026.0 # kg m⁻³, average density at the surface of the world ocean
cᴾ = 3991.0 # J K⁻¹ kg⁻¹, typical heat capacity for seawater

Qᵀ(t) = ifelse(t &lt; 30days, Qʰ / (ρₒ * cᴾ), 0.0) # K m s⁻¹, surface _temperature_ flux

T_bcs = FieldBoundaryConditions(
    top = FluxBoundaryCondition(Qᵀ)
    )</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Oceananigans.FieldBoundaryConditions, with boundary conditions
├── west: DefaultBoundaryCondition (FluxBoundaryCondition: Nothing)
├── east: DefaultBoundaryCondition (FluxBoundaryCondition: Nothing)
├── south: DefaultBoundaryCondition (FluxBoundaryCondition: Nothing)
├── north: DefaultBoundaryCondition (FluxBoundaryCondition: Nothing)
├── bottom: DefaultBoundaryCondition (FluxBoundaryCondition: Nothing)
├── top: FluxBoundaryCondition: ContinuousBoundaryFunction Qᵀ at (Nothing, Nothing, Nothing)
└── immersed: DefaultBoundaryCondition (FluxBoundaryCondition: Nothing)</code></pre><p>For air-sea CO₂ fluxes, we use a FluxBoundaryCondition for the &quot;top&quot; of the DIC tracer. We&#39;ll write a callback to calculate the flux every time step.</p><pre><code class="language-julia hljs">co₂_flux = Field{Center, Center, Nothing}(grid)

dic_bcs  = FieldBoundaryConditions(
    top = FluxBoundaryCondition(co₂_flux)
    )

# These are filled in compute_co₂_flux!
ocean_pCO₂ = Field{Center, Center, Nothing}(grid)
atmos_pCO₂ = Field{Center, Center, Nothing}(grid)
pH         = Field{Center, Center, Nothing}(grid)
set!(pH, 8.0)

cmhr⁻¹_per_ms⁻¹ = 1 / 3.6e5 # conversion factor from cm/hr to m/s

# Supply some coefficients and external data for the CO₂ flux calculation
Base.@kwdef struct CO₂_flux_parameters
    surface_wind_speed   = 10. # ms⁻¹
    applied_pressure     = 0.0 # atm
    atmospheric_pCO₂     = 280e-6 # atm
    exchange_coefficient = 0.337 # cm hr⁻¹
    reference_density    = 1024.5 # kg m⁻³
end
adapt_structure(
    to, cp::CO₂_flux_parameters
    ) = CO₂_flux_parameters(
           adapt(to, cp.surface_wind_speed),
           adapt(to, cp.applied_pressure),
           adapt(to, cp.atmospheric_pCO₂),
           adapt(to, cp.exchange_coefficient),
           adapt(to, cp.reference_density),
)

&quot;&quot;&quot;
    compute_schmidt_dic(
        grid,
        schmidt_number_dic,
        temperature,
        )

Compute the Schmidt number for dissolved inorganic carbon (DIC) based on the temperature Θᶜ (in degrees Celsius).

Arguments:
- `grid::RectilinearGrid`: The model grid.
- `schmidt_number_dic::Field{Center, Center, Nothing}`: The computed Schmidt number for DIC.
- `temperature::Field{Center, Center, Nothing}`: Temperature in degrees Celsius.
- `kˢᶜ::CarbonCoefficientParameters`: The parameters for the Schmidt number calculation.
&quot;&quot;&quot;
@kernel function compute_schmidt_dic!(
    grid,
    schmidt_number_dic,
    temperature,
    kˢᶜ = CarbonCoefficientParameters(
            a₀ = 2116.8,
            a₁ = 136.25,
            a₂ = 4.7353,
            a₃ = 9.2307e-2,
            a₄ = 7.555e-4,
            a₅ = 660.0,
        ),
    )

    i, j = @index(Global, NTuple)
    k = size(grid, 3)

    schmidt_number_dic[i, j, 1] =  (
         kˢᶜ.a₀ -
         kˢᶜ.a₁ * temperature[i, j, k] +
         kˢᶜ.a₂ * temperature[i, j, k]^2 -
         kˢᶜ.a₃ * temperature[i, j, k]^3 +
         kˢᶜ.a₄ * temperature[i, j, k]^4
    ) /  kˢᶜ.a₅
end

&quot;&quot;&quot;
    compute_piston_velocity(
        grid,
        piston_velocity,
        surface_wind_speed,
        exchange_coefficient,
        schmidt_number,
        )

Compute the piston velocity for gas exchange at the ocean surface.

Arguments:
- `grid::RectilinearGrid`: The model grid.
- `piston_velocity::Field{Center, Center, Nothing}`: The computed piston velocity.
- `surface_wind_speed::Field{Center, Center, Nothing}`: The wind speed at the ocean surface.
- `exchange_coefficient::Float64`: The gas exchange coefficient.
- `schmidt_number::Field{Center, Center, Nothing}`: The Schmidt number.
&quot;&quot;&quot;
@kernel function compute_piston_velocity!(
    grid,
    piston_velocity,
    surface_wind_speed,
    exchange_coefficient,
    schmidt_number
    )

    i, j = @index(Global, NTuple)

    piston_velocity[i, j, 1] = exchange_coefficient[i, j, 1] *
                               surface_wind_speed[i, j, 1]^2 /
                               sqrt(schmidt_number[i, j, 1])
end

&quot;&quot;&quot;
    solve_ocean_pCO₂!(
        grid,
        reference_density,
        ocean_pCO₂,
        atmospheric_CO₂_solubility,
        oceanic_CO₂_solubility,
        Θᶜ, Sᴬ, Δpᵦₐᵣ, Cᵀ, Aᵀ, Pᵀ, Siᵀ, pH, pCO₂ᵃᵗᵐ
        )

Compute the oceanic pCO₂ using the UniversalRobustCarbonSystem solver.

Arguments:
- `grid::RectilinearGrid`: The model grid.
- `reference_density::Float64`: The reference density of seawater.
- `ocean_pCO₂::Field{Center, Center, Nothing}`: The computed oceanic pCO₂.
- `atmospheric_CO₂_solubility::Field{Center, Center, Nothing}`: The solubility of CO₂ in the atmosphere.
- `oceanic_CO₂_solubility::Field{Center, Center, Nothing}`: The solubility of CO₂ in the ocean.
- `Θᶜ::Field{Center, Center, Nothing}`: Temperature in degrees Celsius.
- `Sᴬ::Field{Center, Center, Nothing}`: Salinity in PSU.
- `Δpᵦₐᵣ::Field{Center, Center, Nothing}`: Applied pressure in atm.
- `Cᵀ::Field{Center, Center, Nothing}`: Total dissolved inorganic carbon (DIC) in mol kg⁻¹.
- `Aᵀ::Field{Center, Center, Nothing}`: Total alkalinity (ALK) in mol kg⁻¹.
- `Pᵀ::Field{Center, Center, Nothing}`: Phosphate concentration in mol kg⁻¹.
- `pH::Field{Center, Center, Center}`: The computed pH.
- `pCO₂ᵃᵗᵐ::Field{Center, Center, Nothing}`: The partial pressure of CO₂ in the atmosphere.
&quot;&quot;&quot;
@kernel function solve_ocean_pCO₂!(
    grid,
    solver_params,
    reference_density,
    ocean_pCO₂,
    atmospheric_CO₂_solubility,
    oceanic_CO₂_solubility,
    temperature,
    salinity,
    applied_pressure_bar,
    DIC,
    ALK,
    PO4,
    pH,
    atmosphere_pCO₂
    )

    i, j = @index(Global, NTuple)
    k = size(grid, 3)

    # compute oceanic pCO₂ using the UniversalRobustCarbonSystem solver
    CarbonSolved = UniversalRobustCarbonSystem(;
                        pH      = pH[i, j, 1],
                        pCO₂ᵃᵗᵐ = atmosphere_pCO₂[i, j, 1],
                        Θᶜ      = temperature[i, j, k],
                        Sᴬ      = salinity[i, j, k],
                        Δpᵦₐᵣ   = applied_pressure_bar[i, j, 1],
                        Cᵀ      = DIC[i, j, k]/reference_density,
                        Aᵀ      = ALK[i, j, k]/reference_density,
                        Pᵀ      = PO4[i, j, k]/reference_density,
                        solver_params...,
    )

    ocean_pCO₂[i, j, 1]                 = CarbonSolved.pCO₂ᵒᶜᵉ
    atmospheric_CO₂_solubility[i, j, 1] = CarbonSolved.Pᵈⁱᶜₖₛₒₗₐ
    oceanic_CO₂_solubility[i, j, 1]     = CarbonSolved.Pᵈⁱᶜₖₛₒₗₒ
    pH[i, j, 1]                         = CarbonSolved.pH
end

&quot;&quot;&quot;
    compute_CO₂_flux(
        grid,
        CO₂_flux,
        piston_velocity,
        atmospheric_pCO₂,
        oceanic_pCO₂,
        atmospheric_CO₂_solubility,
        oceanic_CO₂_solubility,
        reference_density
    )

Compute the flux of CO₂ between the atmosphere and the ocean.

Arguments:
- `grid::RectilinearGrid`: The model grid.
- `reference_density::Float64`: The reference density of seawater.
- `CO₂_flux::Field{Center, Center, Nothing}`: The computed CO₂ flux.
- `piston_velocity::Field{Center, Center, Nothing}`: The piston velocity for gas exchange at the ocean surface.
- `atmospheric_pCO₂::Float64`: The partial pressure of CO₂ in the atmosphere.
- `oceanic_pCO₂::Field{Center, Center, Nothing}`: The partial pressure of CO₂ in the ocean.
- `atmospheric_CO₂_solubility::Field{Center, Center, Nothing}`: The solubility of CO₂ in the atmosphere.
- `oceanic_CO₂_solubility::Field{Center, Center, Nothing}`: The solubility of CO₂ in the ocean.

Notes:
The convention is that a positive flux is upwards (outgassing), and a negative flux is downwards (uptake).
&quot;&quot;&quot;
@kernel function compute_CO₂_flux!(
    grid,
    reference_density,
    CO₂_flux,
    piston_velocity,
    atmospheric_pCO₂,
    oceanic_pCO₂,
    atmospheric_CO₂_solubility,
    oceanic_CO₂_solubility,
    )
    i, j = @index(Global, NTuple)

    # compute CO₂ flux (-ve for uptake, +ve for outgassing since convention is +ve upwards)
    CO₂_flux[i, j, 1] = - piston_velocity[i, j, 1] * (
                 atmospheric_pCO₂[i, j, 1] * atmospheric_CO₂_solubility[i, j, 1] -
                 oceanic_pCO₂[i, j, 1]     * oceanic_CO₂_solubility[i, j, 1]
            ) * reference_density # Convert mol kg⁻¹ m s⁻¹ to mol m⁻² s⁻¹
end

&quot;&quot;&quot;
    calculate_air_sea_carbon_exchange!(simulation; solver_params = ())

Returns the tendency of DIC in the top layer due to air-sea CO₂ flux
using the piston velocity formulation of Wanninkhof (1992) and the
solubility/activity of CO₂ in seawater.
&quot;&quot;&quot;
@inline function calculate_air_sea_carbon_exchange!(simulation, solver_params = ())
    grid = simulation.model.grid

# get coefficients from CO₂_flux_parameters struct
# I really want the option to take these from the model
    (; surface_wind_speed,
        applied_pressure,
        atmospheric_pCO₂,
        exchange_coefficient,
        reference_density,
        ) = CO₂_flux_parameters()

    # Access model fields
    CO₂_flux = simulation.model.tracers.DIC.boundary_conditions.top.condition
    temperature = simulation.model.tracers.T
    salinity    = simulation.model.tracers.S
    DIC         = simulation.model.tracers.DIC
    ALK         = simulation.model.tracers.ALK
    PO₄         = simulation.model.tracers.PO₄

    # compute schmidt number for DIC
    schmidt_dic = Field{Center, Center, Nothing}(grid)
    set!(schmidt_dic, 0)

    kernel_args = (
        grid,
        schmidt_dic,
        temperature,
    )

    launch!(arch,
	    grid,
	    :xy,
	    compute_schmidt_dic!,
	    kernel_args...,
    )

    # compute gas exchange coefficient/piston velocity and correct with Schmidt number
    wind_speed = Field{Center, Center, Nothing}(grid)
    set!(wind_speed, surface_wind_speed)

    average_exchange_coefficient = Field{Center, Center, Nothing}(grid)
    set!(average_exchange_coefficient, exchange_coefficient*cmhr⁻¹_per_ms⁻¹)

    piston_velocity = Field{Center, Center, Nothing}(grid)
    set!(piston_velocity, 0)

    kernel_args = (
        grid,
        piston_velocity,
        wind_speed,
        average_exchange_coefficient,
        schmidt_dic,
        )

    # This is a 2d only kernel, so no need for custom kernel_size to handle slicing of 3d inputs
    launch!(arch,
	    grid,
	    :xy,
	    compute_piston_velocity!,
	    kernel_args...,
    )

    # compute oceanic pCO₂ using the UniversalRobustCarbonSystem solver
    set!(atmos_pCO₂, atmospheric_pCO₂)

    applied_pressure_bar = Field{Center, Center, Nothing}(grid)
    set!(applied_pressure_bar, applied_pressure)

    atmospheric_CO₂_solubility = Field{Center, Center, Nothing}(grid)
    oceanic_CO₂_solubility     = Field{Center, Center, Nothing}(grid)

    kernel_args = (
        grid,
        solver_params,
        reference_density,
        ocean_pCO₂,
        atmospheric_CO₂_solubility,
        oceanic_CO₂_solubility,
        temperature,
        salinity,
        applied_pressure_bar,
        DIC,
        ALK,
        PO₄,
        pH,
        atmos_pCO₂,
        )

    launch!(arch,
	    grid,
	    :xy,
	    solve_ocean_pCO₂!,
	    kernel_args...,
    )

    # compute CO₂ flux (-ve for uptake, +ve for outgassing since convention is +ve upwards)
    kernel_args = (
        grid,
        reference_density,
        CO₂_flux,
        piston_velocity,
        atmos_pCO₂,
        ocean_pCO₂,
        atmospheric_CO₂_solubility,
        oceanic_CO₂_solubility,
        )

    launch!(arch,
	    grid,
	    :xy,
	    compute_CO₂_flux!,
	    kernel_args...,
    )
    return nothing
end</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Main.calculate_air_sea_carbon_exchange!</code></pre><h2 id="We-put-the-pieces-together"><a class="docs-heading-anchor" href="#We-put-the-pieces-together">We put the pieces together</a><a id="We-put-the-pieces-together-1"></a><a class="docs-heading-anchor-permalink" href="#We-put-the-pieces-together" title="Permalink"></a></h2><p>The important line here is <code>biogeochemistry = CarbonAlkalinityNutrients(; grid)</code>. We adjust some of the parameters of the model to make the simulation more interesting.</p><pre><code class="language-julia hljs">model = HydrostaticFreeSurfaceModel(;
    grid,
    biogeochemistry     = CarbonAlkalinityNutrients(; grid,
                            maximum_net_community_production_rate = 1/365.25day,
                            PAR_attenuation_scale = 100.,
                            particulate_organic_phosphorus_sinking_velocity = -10 / day,
                            ),
    closure             = ScalarDiffusivity(κ=1e-4),
    tracers             = (
        :T, :S, :DIC, :ALK, :PO₄, :NO₃, :DOP, :POP, :Fe
        ),
    tracer_advection    = WENO(),
    buoyancy            = SeawaterBuoyancy(
        equation_of_state  = LinearEquationOfState(
            thermal_expansion  = αᵀ,
            haline_contraction = βˢ
            ),
        ),
    boundary_conditions = (;
        T=T_bcs, DIC=dic_bcs
        ),
    )</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">HydrostaticFreeSurfaceModel{CPU, RectilinearGrid}(time = 0 seconds, iteration = 0)
├── grid: 1×1×512 RectilinearGrid{Float64, Oceananigans.Grids.Flat, Oceananigans.Grids.Flat, Oceananigans.Grids.Bounded} on Oceananigans.Architectures.CPU with 0×0×3 halo
├── timestepper: QuasiAdamsBashforth2TimeStepper
├── tracers: (T, S, DIC, ALK, PO₄, NO₃, DOP, POP, Fe)
├── closure: ScalarDiffusivity{ExplicitTimeDiscretization}(ν=0.0, κ=(T=0.0001, S=0.0001, DIC=0.0001, ALK=0.0001, PO₄=0.0001, NO₃=0.0001, DOP=0.0001, POP=0.0001, Fe=0.0001))
├── buoyancy: SeawaterBuoyancy with g=9.80665 and LinearEquationOfState(thermal_expansion=0.0002, haline_contraction=0.0008) with ĝ = NegativeZDirection()
├── advection scheme: 
│   ├── momentum: Centered reconstruction order 2
│   ├── T: WENO reconstruction order 5
│   ├── S: WENO reconstruction order 5
│   ├── DIC: WENO reconstruction order 5
│   ├── ALK: WENO reconstruction order 5
│   ├── PO₄: WENO reconstruction order 5
│   ├── NO₃: WENO reconstruction order 5
│   ├── DOP: WENO reconstruction order 5
│   ├── POP: WENO reconstruction order 5
│   └── Fe: WENO reconstruction order 5
└── coriolis: Nothing</code></pre><h2 id="Initial-conditions"><a class="docs-heading-anchor" href="#Initial-conditions">Initial conditions</a><a id="Initial-conditions-1"></a><a class="docs-heading-anchor-permalink" href="#Initial-conditions" title="Permalink"></a></h2><p>Temperature initial condition: a stable density gradient with random noise superposed. Random noise damped at top and bottom we also impose a temperature gradient <code>dTdz</code></p><pre><code class="language-julia hljs">dTdz = 0.02 # K m⁻¹

# Random noise
Ξ(z) = randn() * z / model.grid.Lz * (1 + z / model.grid.Lz)
zᶜʳⁱᵗ = -500
fᶻ = dTdz * model.grid.Lz * 1e-6</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">8.192e-5</code></pre><p>Temperature profile</p><pre><code class="language-julia hljs">Tᵢ(z) = ifelse(
                z &gt; zᶜʳⁱᵗ,
                20 + dTdz * z + fᶻ * Ξ(z),
                20 + dTdz * zᶜʳⁱᵗ + fᶻ * Ξ(z),
        )</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Tᵢ (generic function with 1 method)</code></pre><p>We initialize the model with reasonable salinity and carbon/alkalinity/nutrient concentrations</p><pre><code class="language-julia hljs">Sᵢ(z)   = 35.0  # psu
DICᵢ(z) = 2.1   # mol/m³
ALKᵢ(z) = 2.35   # mol/m³
PO₄ᵢ(z) = 2.5e-3 # mol/m³
NO₃ᵢ(z) = 42e-3  # mol/m³
DOPᵢ(z) = 0.0    # mol/m³
POPᵢ(z) = 0.0    # mol/m³
Feᵢ(z)  = 2.e-6  # mol/m³

set!(
    model,
    T   = Tᵢ,
    S   = Sᵢ,
    DIC = DICᵢ,
    ALK = ALKᵢ,
    PO₄ = PO₄ᵢ,
    NO₃ = NO₃ᵢ,
    DOP = DOPᵢ,
    POP = POPᵢ,
    Fe  = Feᵢ
    )</code></pre><h2 id="A-simulation-of-physical-biological-interaction"><a class="docs-heading-anchor" href="#A-simulation-of-physical-biological-interaction">A simulation of physical-biological interaction</a><a id="A-simulation-of-physical-biological-interaction-1"></a><a class="docs-heading-anchor-permalink" href="#A-simulation-of-physical-biological-interaction" title="Permalink"></a></h2><p>We run the simulation for 30 days with a time-step of 10 minutes.</p><pre><code class="language-julia hljs">simulation = Simulation(
    model,
    Δt=1minute,
    stop_time=365.25days
    )</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Simulation of HydrostaticFreeSurfaceModel{CPU, RectilinearGrid}(time = 0 seconds, iteration = 0)
├── Next time step: 1 minute
├── Elapsed wall time: 0 seconds
├── Wall time per iteration: NaN days
├── Stop time: 365.250 days
├── Stop iteration : Inf
├── Wall time limit: Inf
├── Callbacks: OrderedDict with 4 entries:
│   ├── stop_time_exceeded =&gt; Callback of stop_time_exceeded on IterationInterval(1)
│   ├── stop_iteration_exceeded =&gt; Callback of stop_iteration_exceeded on IterationInterval(1)
│   ├── wall_time_limit_exceeded =&gt; Callback of wall_time_limit_exceeded on IterationInterval(1)
│   └── nan_checker =&gt; Callback of NaNChecker for u on IterationInterval(100)
├── Output writers: OrderedDict with no entries
└── Diagnostics: OrderedDict with no entries</code></pre><p>We add a <code>TimeStepWizard</code> callback to adapt the simulation&#39;s time-step...</p><pre><code class="language-julia hljs">wizard = TimeStepWizard(
    cfl=0.2,
    max_change=1.1,
    max_Δt=60minutes,
    )

simulation.callbacks[:wizard] = Callback(
    wizard,
    IterationInterval(100),
    )</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Callback of TimeStepWizard(cfl=0.2, max_Δt=3600.0, min_Δt=0.0) on IterationInterval(100)</code></pre><p>...and we emit a message with information on DIC, ALK, and CO₂ flux tendencies.</p><pre><code class="language-julia hljs">DIC₀ = Field{Center, Center, Nothing}(grid)
ALK₀ = Field{Center, Center, Nothing}(grid)
&quot;&quot;&quot;
Function to print DIC, ALK, and CO₂ flux tendency during the simulation
&quot;&quot;&quot;
function progress(simulation)
    @printf(&quot;Iteration: %d, time: %s\n&quot;,
        iteration(simulation),
        prettytime(simulation),
        )
    Nz = size(simulation.model.grid, 3)

    if iteration(simulation) == 1
        # Establish and set initial values for the anomaly fields
        DIC₀[1, 1, 1] = simulation.model.tracers.DIC[1, 1, Nz]
        ALK₀[1, 1, 1] = simulation.model.tracers.ALK[1, 1, Nz]
    else
        @printf(&quot;Surface DIC tendency (x10⁻⁷ mol m⁻³ s⁻¹): %.12f\n&quot;,
            ((simulation.model.tracers.DIC[1, 1, grid.Nz]-
                DIC₀[1, 1, 1])/simulation.Δt
                ) * 1e7)
        @printf(&quot;Surface ALK tendency (x10⁻⁷ mol m⁻³ s⁻¹): %.12f\n&quot;,
            ((simulation.model.tracers.ALK[1, 1, grid.Nz]-
                ALK₀[1, 1, 1])/simulation.Δt
                ) * 1e7)
        @printf(&quot;Surface CO₂ flux (x10⁻⁷ mol m⁻³ s⁻¹): %.12f\n&quot;,
            (simulation.model.tracers.DIC.boundary_conditions.top.condition[1,1]
            ) * 1e7)

        # update the anomaly fields
        DIC₀[1, 1, 1] = simulation.model.tracers.DIC[1, 1, Nz]
        ALK₀[1, 1, 1] = simulation.model.tracers.ALK[1, 1, Nz]
    end
end

simulation.callbacks[:progress] = Callback(
    progress,
    IterationInterval(100),
    )</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Callback of progress on IterationInterval(100)</code></pre><p>Dont forget to add the callback to compute the CO₂ flux</p><pre><code class="language-julia hljs">add_callback!(simulation, calculate_air_sea_carbon_exchange!)</code></pre><p>Output writer</p><pre><code class="language-julia hljs">filename = &quot;single_column_carbon_alkalinity_nutrients.jld2&quot;
fout=10days
simulation.output_writers[:fields] = JLD2OutputWriter(
    model, model.tracers;
    filename,
    schedule = TimeInterval(fout),
    overwrite_existing = true,
    )

filename_diags = &quot;single_column_carbon_alkalinity_nutrients_co2flux.jld2&quot;

outputs = (; co₂_flux, ocean_pCO₂, atmos_pCO₂)
simulation.output_writers[:jld2] = JLD2OutputWriter(
    model, outputs;
    filename = filename_diags,
    schedule = TimeInterval(fout),
    overwrite_existing = true,
    )</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">JLD2OutputWriter scheduled on TimeInterval(10 days):
├── filepath: ./single_column_carbon_alkalinity_nutrients_co2flux.jld2
├── 3 outputs: (co₂_flux, ocean_pCO₂, atmos_pCO₂)
├── array type: Array{Float64}
├── including: [:grid, :coriolis, :buoyancy, :closure]
├── file_splitting: NoFileSplitting
└── file size: 0.0 B</code></pre><h2 id="Run-the-example"><a class="docs-heading-anchor" href="#Run-the-example">Run the example</a><a id="Run-the-example-1"></a><a class="docs-heading-anchor-permalink" href="#Run-the-example" title="Permalink"></a></h2><pre><code class="language-julia hljs">run!(simulation)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi"><span class="sgr36"><span class="sgr1">[ Info: </span></span>Initializing simulation...
Iteration: 0, time: 0 seconds
Surface DIC tendency (x10⁻⁷ mol m⁻³ s⁻¹): 318181.818181818235
Surface ALK tendency (x10⁻⁷ mol m⁻³ s⁻¹): 356060.606060606078
Surface CO₂ flux (x10⁻⁷ mol m⁻³ s⁻¹): 0.000000000000
<span class="sgr36"><span class="sgr1">[ Info: </span></span>    ... simulation initialization complete (5.502 seconds)
<span class="sgr36"><span class="sgr1">[ Info: </span></span>Executing initial time step...
<span class="sgr36"><span class="sgr1">[ Info: </span></span>    ... initial time step complete (9.444 seconds).
Iteration: 100, time: 1.833 hours
Surface DIC tendency (x10⁻⁷ mol m⁻³ s⁻¹): -843.164949716868
Surface ALK tendency (x10⁻⁷ mol m⁻³ s⁻¹): 113.510674265281
Surface CO₂ flux (x10⁻⁷ mol m⁻³ s⁻¹): 0.987999175678
Iteration: 200, time: 3.850 hours
Surface DIC tendency (x10⁻⁷ mol m⁻³ s⁻¹): -824.982185171857
Surface ALK tendency (x10⁻⁷ mol m⁻³ s⁻¹): 111.590865643358
Surface CO₂ flux (x10⁻⁷ mol m⁻³ s⁻¹): 0.629241976072
Iteration: 300, time: 6.068 hours
Surface DIC tendency (x10⁻⁷ mol m⁻³ s⁻¹): -805.484765405523
Surface ALK tendency (x10⁻⁷ mol m⁻³ s⁻¹): 109.499023863532
Surface CO₂ flux (x10⁻⁷ mol m⁻³ s⁻¹): 0.262845036563
Iteration: 400, time: 8.509 hours
Surface DIC tendency (x10⁻⁷ mol m⁻³ s⁻¹): -784.603330427935
Surface ALK tendency (x10⁻⁷ mol m⁻³ s⁻¹): 107.221860828994
Surface CO₂ flux (x10⁻⁷ mol m⁻³ s⁻¹): -0.109456668477
Iteration: 500, time: 11.193 hours
Surface DIC tendency (x10⁻⁷ mol m⁻³ s⁻¹): -762.268103033281
Surface ALK tendency (x10⁻⁷ mol m⁻³ s⁻¹): 104.745660063480
Surface CO₂ flux (x10⁻⁷ mol m⁻³ s⁻¹): -0.485761096824
Iteration: 600, time: 14.145 hours
Surface DIC tendency (x10⁻⁷ mol m⁻³ s⁻¹): -738.410195362232
Surface ALK tendency (x10⁻⁷ mol m⁻³ s⁻¹): 102.056481093511
Surface CO₂ flux (x10⁻⁷ mol m⁻³ s⁻¹): -0.864024573302
Iteration: 700, time: 17.393 hours
Surface DIC tendency (x10⁻⁷ mol m⁻³ s⁻¹): -712.963317364872
Surface ALK tendency (x10⁻⁷ mol m⁻³ s⁻¹): 99.140454114618
Surface CO₂ flux (x10⁻⁷ mol m⁻³ s⁻¹): -1.242092415352
Iteration: 800, time: 20.966 hours
Surface DIC tendency (x10⁻⁷ mol m⁻³ s⁻¹): -685.866219533112
Surface ALK tendency (x10⁻⁷ mol m⁻³ s⁻¹): 95.984189607290
Surface CO₂ flux (x10⁻⁷ mol m⁻³ s⁻¹): -1.617733844032
Iteration: 900, time: 1.037 days
Surface DIC tendency (x10⁻⁷ mol m⁻³ s⁻¹): -657.066081372368
Surface ALK tendency (x10⁻⁷ mol m⁻³ s⁻¹): 92.575330942115
Surface CO₂ flux (x10⁻⁷ mol m⁻³ s⁻¹): -1.988680046727
Iteration: 1000, time: 1.217 days
Surface DIC tendency (x10⁻⁷ mol m⁻³ s⁻¹): -626.523076657015
Surface ALK tendency (x10⁻⁷ mol m⁻³ s⁻¹): 88.903280139584
Surface CO₂ flux (x10⁻⁷ mol m⁻³ s⁻¹): -2.352664111300
Iteration: 1100, time: 1.416 days
Surface DIC tendency (x10⁻⁷ mol m⁻³ s⁻¹): -594.216346969147
Surface ALK tendency (x10⁻⁷ mol m⁻³ s⁻¹): 84.960126500749
Surface CO₂ flux (x10⁻⁷ mol m⁻³ s⁻¹): -2.707461502854
Iteration: 1200, time: 1.634 days
Surface DIC tendency (x10⁻⁷ mol m⁻³ s⁻¹): -560.151581887249
Surface ALK tendency (x10⁻⁷ mol m⁻³ s⁻¹): 80.741802816211
Surface CO₂ flux (x10⁻⁷ mol m⁻³ s⁻¹): -3.050929809174
Iteration: 1300, time: 1.873 days
Surface DIC tendency (x10⁻⁷ mol m⁻³ s⁻¹): -524.370320710891
Surface ALK tendency (x10⁻⁷ mol m⁻³ s⁻¹): 76.249481988214
Surface CO₂ flux (x10⁻⁷ mol m⁻³ s⁻¹): -3.381046635346
Iteration: 1400, time: 2.137 days
Surface DIC tendency (x10⁻⁷ mol m⁻³ s⁻¹): -486.960929991511
Surface ALK tendency (x10⁻⁷ mol m⁻³ s⁻¹): 71.491204488355
Surface CO₂ flux (x10⁻⁷ mol m⁻³ s⁻¹): -3.695944767156
Iteration: 1500, time: 2.427 days
Surface DIC tendency (x10⁻⁷ mol m⁻³ s⁻¹): -448.070932448292
Surface ALK tendency (x10⁻⁷ mol m⁻³ s⁻¹): 66.483688532869
Surface CO₂ flux (x10⁻⁷ mol m⁻³ s⁻¹): -3.993944017145
Iteration: 1600, time: 2.746 days
Surface DIC tendency (x10⁻⁷ mol m⁻³ s⁻¹): -407.919940847232
Surface ALK tendency (x10⁻⁷ mol m⁻³ s⁻¹): 61.254216691563
Surface CO₂ flux (x10⁻⁷ mol m⁻³ s⁻¹): -4.273579481575
Iteration: 1700, time: 3.097 days
Surface DIC tendency (x10⁻⁷ mol m⁻³ s⁻¹): -366.811888740628
Surface ALK tendency (x10⁻⁷ mol m⁻³ s⁻¹): 55.842415413293
Surface CO₂ flux (x10⁻⁷ mol m⁻³ s⁻¹): -4.533626240378
Iteration: 1800, time: 3.483 days
Surface DIC tendency (x10⁻⁷ mol m⁻³ s⁻¹): -325.144552440619
Surface ALK tendency (x10⁻⁷ mol m⁻³ s⁻¹): 50.301648188291
Surface CO₂ flux (x10⁻⁷ mol m⁻³ s⁻¹): -4.773120776946
Iteration: 1900, time: 3.908 days
Surface DIC tendency (x10⁻⁷ mol m⁻³ s⁻¹): -283.413588134459
Surface ALK tendency (x10⁻⁷ mol m⁻³ s⁻¹): 44.699637426286
Surface CO₂ flux (x10⁻⁷ mol m⁻³ s⁻¹): -4.991379501268
Iteration: 2000, time: 4.375 days
Surface DIC tendency (x10⁻⁷ mol m⁻³ s⁻¹): -242.207719279732
Surface ALK tendency (x10⁻⁷ mol m⁻³ s⁻¹): 39.117849467449
Surface CO₂ flux (x10⁻⁷ mol m⁻³ s⁻¹): -5.188014665095
Iteration: 2100, time: 4.889 days
Surface DIC tendency (x10⁻⁷ mol m⁻³ s⁻¹): -202.191726117916
Surface ALK tendency (x10⁻⁷ mol m⁻³ s⁻¹): 33.649179512990
Surface CO₂ flux (x10⁻⁷ mol m⁻³ s⁻¹): -5.362947651125
Iteration: 2200, time: 5.454 days
Surface DIC tendency (x10⁻⁷ mol m⁻³ s⁻¹): -164.074917885173
Surface ALK tendency (x10⁻⁷ mol m⁻³ s⁻¹): 28.393614438300
Surface CO₂ flux (x10⁻⁷ mol m⁻³ s⁻¹): -5.516419115602
Iteration: 2300, time: 6.076 days
Surface DIC tendency (x10⁻⁷ mol m⁻³ s⁻¹): -128.565033482985
Surface ALK tendency (x10⁻⁷ mol m⁻³ s⁻¹): 23.451862227600
Surface CO₂ flux (x10⁻⁷ mol m⁻³ s⁻¹): -5.648994775562
Iteration: 2400, time: 6.760 days
Surface DIC tendency (x10⁻⁷ mol m⁻³ s⁻¹): -96.310898441051
Surface ALK tendency (x10⁻⁷ mol m⁻³ s⁻¹): 18.917400855581
Surface CO₂ flux (x10⁻⁷ mol m⁻³ s⁻¹): -5.761564808934
Iteration: 2500, time: 7.513 days
Surface DIC tendency (x10⁻⁷ mol m⁻³ s⁻¹): -67.840996553135
Surface ALK tendency (x10⁻⁷ mol m⁻³ s⁻¹): 14.867925444465
Surface CO₂ flux (x10⁻⁷ mol m⁻³ s⁻¹): -5.855334009480
Iteration: 2600, time: 8.340 days
Surface DIC tendency (x10⁻⁷ mol m⁻³ s⁻¹): -43.508153737070
Surface ALK tendency (x10⁻⁷ mol m⁻³ s⁻¹): 11.357590924811
Surface CO₂ flux (x10⁻⁷ mol m⁻³ s⁻¹): -5.931799254885
Iteration: 2700, time: 9.251 days
Surface DIC tendency (x10⁻⁷ mol m⁻³ s⁻¹): -23.451367096001
Surface ALK tendency (x10⁻⁷ mol m⁻³ s⁻¹): 8.411565123483
Surface CO₂ flux (x10⁻⁷ mol m⁻³ s⁻¹): -5.992710872591
Iteration: 2800, time: 10.250 days
Surface DIC tendency (x10⁻⁷ mol m⁻³ s⁻¹): -7.582777272080
Surface ALK tendency (x10⁻⁷ mol m⁻³ s⁻¹): 6.015333613024
Surface CO₂ flux (x10⁻⁷ mol m⁻³ s⁻¹): -6.039946921796
Iteration: 2900, time: 11.352 days
Surface DIC tendency (x10⁻⁷ mol m⁻³ s⁻¹): 4.375098149156
Surface ALK tendency (x10⁻⁷ mol m⁻³ s⁻¹): 4.163212853902
Surface CO₂ flux (x10⁻⁷ mol m⁻³ s⁻¹): -6.075734338302
Iteration: 3000, time: 12.564 days
Surface DIC tendency (x10⁻⁷ mol m⁻³ s⁻¹): 12.923905564708
Surface ALK tendency (x10⁻⁷ mol m⁻³ s⁻¹): 2.765246951783
Surface CO₂ flux (x10⁻⁷ mol m⁻³ s⁻¹): -6.102074232826
Iteration: 3100, time: 13.897 days
Surface DIC tendency (x10⁻⁷ mol m⁻³ s⁻¹): 18.603818421004
Surface ALK tendency (x10⁻⁷ mol m⁻³ s⁻¹): 1.761307415718
Surface CO₂ flux (x10⁻⁷ mol m⁻³ s⁻¹): -6.120999398150
Iteration: 3200, time: 15.363 days
Surface DIC tendency (x10⁻⁷ mol m⁻³ s⁻¹): 22.017040165802
Surface ALK tendency (x10⁻⁷ mol m⁻³ s⁻¹): 1.072845986854
Surface CO₂ flux (x10⁻⁷ mol m⁻³ s⁻¹): -6.134382392732
Iteration: 3300, time: 16.976 days
Surface DIC tendency (x10⁻⁷ mol m⁻³ s⁻¹): 23.742322818572
Surface ALK tendency (x10⁻⁷ mol m⁻³ s⁻¹): 0.623559938412
Surface CO₂ flux (x10⁻⁷ mol m⁻³ s⁻¹): -6.143858587201
Iteration: 3400, time: 18.750 days
Surface DIC tendency (x10⁻⁷ mol m⁻³ s⁻¹): 24.289484064025
Surface ALK tendency (x10⁻⁷ mol m⁻³ s⁻¹): 0.345616066269
Surface CO₂ flux (x10⁻⁷ mol m⁻³ s⁻¹): -6.150776328745
Iteration: 3500, time: 20.683 days
Surface DIC tendency (x10⁻⁷ mol m⁻³ s⁻¹): 23.848501253312
Surface ALK tendency (x10⁻⁷ mol m⁻³ s⁻¹): 0.182102249688
Surface CO₂ flux (x10⁻⁷ mol m⁻³ s⁻¹): -6.156135777693
Iteration: 3600, time: 22.830 days
Surface DIC tendency (x10⁻⁷ mol m⁻³ s⁻¹): 23.412205045751
Surface ALK tendency (x10⁻⁷ mol m⁻³ s⁻¹): 0.094880569738
Surface CO₂ flux (x10⁻⁷ mol m⁻³ s⁻¹): -6.160789493770
Iteration: 3700, time: 25.191 days
Surface DIC tendency (x10⁻⁷ mol m⁻³ s⁻¹): 22.510095451979
Surface ALK tendency (x10⁻⁷ mol m⁻³ s⁻¹): 0.048994387937
Surface CO₂ flux (x10⁻⁷ mol m⁻³ s⁻¹): -6.165189345355
Iteration: 3800, time: 27.789 days
Surface DIC tendency (x10⁻⁷ mol m⁻³ s⁻¹): 21.510677606648
Surface ALK tendency (x10⁻⁷ mol m⁻³ s⁻¹): 0.027169250309
Surface CO₂ flux (x10⁻⁷ mol m⁻³ s⁻¹): -6.169651913760
Iteration: 3900, time: 30.629 days
Surface DIC tendency (x10⁻⁷ mol m⁻³ s⁻¹): 20.322320872637
Surface ALK tendency (x10⁻⁷ mol m⁻³ s⁻¹): 0.017495683899
Surface CO₂ flux (x10⁻⁷ mol m⁻³ s⁻¹): -6.131167774103
Iteration: 4000, time: 33.772 days
Surface DIC tendency (x10⁻⁷ mol m⁻³ s⁻¹): 18.139517089332
Surface ALK tendency (x10⁻⁷ mol m⁻³ s⁻¹): 0.013733952177
Surface CO₂ flux (x10⁻⁷ mol m⁻³ s⁻¹): -5.951321179231
Iteration: 4100, time: 37.229 days
Surface DIC tendency (x10⁻⁷ mol m⁻³ s⁻¹): 15.988759287222
Surface ALK tendency (x10⁻⁷ mol m⁻³ s⁻¹): 0.012289077895
Surface CO₂ flux (x10⁻⁷ mol m⁻³ s⁻¹): -5.802011573501
Iteration: 4200, time: 41.027 days
Surface DIC tendency (x10⁻⁷ mol m⁻³ s⁻¹): 14.420814946827
Surface ALK tendency (x10⁻⁷ mol m⁻³ s⁻¹): 0.011811226464
Surface CO₂ flux (x10⁻⁷ mol m⁻³ s⁻¹): -5.669704046703
Iteration: 4300, time: 45.193 days
Surface DIC tendency (x10⁻⁷ mol m⁻³ s⁻¹): 14.382460343091
Surface ALK tendency (x10⁻⁷ mol m⁻³ s⁻¹): 0.012746863420
Surface CO₂ flux (x10⁻⁷ mol m⁻³ s⁻¹): -5.547362776155
Iteration: 4400, time: 49.360 days
Surface DIC tendency (x10⁻⁷ mol m⁻³ s⁻¹): 13.195691020975
Surface ALK tendency (x10⁻⁷ mol m⁻³ s⁻¹): 0.012639882911
Surface CO₂ flux (x10⁻⁷ mol m⁻³ s⁻¹): -5.440617024120
Iteration: 4500, time: 53.500 days
Surface DIC tendency (x10⁻⁷ mol m⁻³ s⁻¹): 12.145541134039
Surface ALK tendency (x10⁻⁷ mol m⁻³ s⁻¹): 0.012479033166
Surface CO₂ flux (x10⁻⁷ mol m⁻³ s⁻¹): -5.345627410114
Iteration: 4600, time: 57.667 days
Surface DIC tendency (x10⁻⁷ mol m⁻³ s⁻¹): 11.401278293276
Surface ALK tendency (x10⁻⁷ mol m⁻³ s⁻¹): 0.012484928920
Surface CO₂ flux (x10⁻⁷ mol m⁻³ s⁻¹): -5.258478051391
Iteration: 4700, time: 61.833 days
Surface DIC tendency (x10⁻⁷ mol m⁻³ s⁻¹): 10.687412753966
Surface ALK tendency (x10⁻⁷ mol m⁻³ s⁻¹): 0.012410138745
Surface CO₂ flux (x10⁻⁷ mol m⁻³ s⁻¹): -5.178061176528
Iteration: 4800, time: 66 days
Surface DIC tendency (x10⁻⁷ mol m⁻³ s⁻¹): 10.061030400344
Surface ALK tendency (x10⁻⁷ mol m⁻³ s⁻¹): 0.012334862895
Surface CO₂ flux (x10⁻⁷ mol m⁻³ s⁻¹): -5.103163786146
Iteration: 4900, time: 70.167 days
Surface DIC tendency (x10⁻⁷ mol m⁻³ s⁻¹): 9.505053739575
Surface ALK tendency (x10⁻⁷ mol m⁻³ s⁻¹): 0.012259055985
Surface CO₂ flux (x10⁻⁷ mol m⁻³ s⁻¹): -5.032906185264
Iteration: 5000, time: 74.333 days
Surface DIC tendency (x10⁻⁷ mol m⁻³ s⁻¹): 9.007015364603
Surface ALK tendency (x10⁻⁷ mol m⁻³ s⁻¹): 0.012182834248
Surface CO₂ flux (x10⁻⁷ mol m⁻³ s⁻¹): -4.966626194609
Iteration: 5100, time: 78.500 days
Surface DIC tendency (x10⁻⁷ mol m⁻³ s⁻¹): 8.557490879095
Surface ALK tendency (x10⁻⁷ mol m⁻³ s⁻¹): 0.012106327068
Surface CO₂ flux (x10⁻⁷ mol m⁻³ s⁻¹): -4.903810317049
Iteration: 5200, time: 82.667 days
Surface DIC tendency (x10⁻⁷ mol m⁻³ s⁻¹): 8.149161974697
Surface ALK tendency (x10⁻⁷ mol m⁻³ s⁻¹): 0.012029648213
Surface CO₂ flux (x10⁻⁷ mol m⁻³ s⁻¹): -4.844050552371
Iteration: 5300, time: 86.833 days
Surface DIC tendency (x10⁻⁷ mol m⁻³ s⁻¹): 7.776222552005
Surface ALK tendency (x10⁻⁷ mol m⁻³ s⁻¹): 0.011952893194
Surface CO₂ flux (x10⁻⁷ mol m⁻³ s⁻¹): -4.787016091121
Iteration: 5400, time: 91 days
Surface DIC tendency (x10⁻⁷ mol m⁻³ s⁻¹): 7.433984568302
Surface ALK tendency (x10⁻⁷ mol m⁻³ s⁻¹): 0.011876141569
Surface CO₂ flux (x10⁻⁷ mol m⁻³ s⁻¹): -4.732434076281
Iteration: 5500, time: 95.167 days
Surface DIC tendency (x10⁻⁷ mol m⁻³ s⁻¹): 7.118606605158
Surface ALK tendency (x10⁻⁷ mol m⁻³ s⁻¹): 0.011799459872
Surface CO₂ flux (x10⁻⁷ mol m⁻³ s⁻¹): -4.680076122958
Iteration: 5600, time: 99.333 days
Surface DIC tendency (x10⁻⁷ mol m⁻³ s⁻¹): 6.826901215086
Surface ALK tendency (x10⁻⁷ mol m⁻³ s⁻¹): 0.011722903972
Surface CO₂ flux (x10⁻⁷ mol m⁻³ s⁻¹): -4.629748623599
Iteration: 5700, time: 103.500 days
Surface DIC tendency (x10⁻⁷ mol m⁻³ s⁻¹): 6.556194700224
Surface ALK tendency (x10⁻⁷ mol m⁻³ s⁻¹): 0.011646521060
Surface CO₂ flux (x10⁻⁷ mol m⁻³ s⁻¹): -4.581285617127
Iteration: 5800, time: 107.667 days
Surface DIC tendency (x10⁻⁷ mol m⁻³ s⁻¹): 6.304222858135
Surface ALK tendency (x10⁻⁷ mol m⁻³ s⁻¹): 0.011570351144
Surface CO₂ flux (x10⁻⁷ mol m⁻³ s⁻¹): -4.534543439971
Iteration: 5900, time: 111.833 days
Surface DIC tendency (x10⁻⁷ mol m⁻³ s⁻¹): 6.069052040705
Surface ALK tendency (x10⁻⁷ mol m⁻³ s⁻¹): 0.011494428326
Surface CO₂ flux (x10⁻⁷ mol m⁻³ s⁻¹): -4.489396643749
Iteration: 6000, time: 116 days
Surface DIC tendency (x10⁻⁷ mol m⁻³ s⁻¹): 5.849018424126
Surface ALK tendency (x10⁻⁷ mol m⁻³ s⁻¹): 0.011418781683
Surface CO₂ flux (x10⁻⁷ mol m⁻³ s⁻¹): -4.445734831469
Iteration: 6100, time: 120.167 days
Surface DIC tendency (x10⁻⁷ mol m⁻³ s⁻¹): 5.642680633189
Surface ALK tendency (x10⁻⁷ mol m⁻³ s⁻¹): 0.011343436180
Surface CO₂ flux (x10⁻⁷ mol m⁻³ s⁻¹): -4.403460171692
Iteration: 6200, time: 124.333 days
Surface DIC tendency (x10⁻⁷ mol m⁻³ s⁻¹): 5.448782323716
Surface ALK tendency (x10⁻⁷ mol m⁻³ s⁻¹): 0.011268413224
Surface CO₂ flux (x10⁻⁷ mol m⁻³ s⁻¹): -4.362485421097
Iteration: 6300, time: 128.500 days
Surface DIC tendency (x10⁻⁷ mol m⁻³ s⁻¹): 5.266222301582
Surface ALK tendency (x10⁻⁷ mol m⁻³ s⁻¹): 0.011193731212
Surface CO₂ flux (x10⁻⁷ mol m⁻³ s⁻¹): -4.322732333805
Iteration: 6400, time: 132.667 days
Surface DIC tendency (x10⁻⁷ mol m⁻³ s⁻¹): 5.094030421546
Surface ALK tendency (x10⁻⁷ mol m⁻³ s⁻¹): 0.011119405989
Surface CO₂ flux (x10⁻⁷ mol m⁻³ s⁻¹): -4.284130368715
Iteration: 6500, time: 136.833 days
Surface DIC tendency (x10⁻⁷ mol m⁻³ s⁻¹): 4.931347971651
Surface ALK tendency (x10⁻⁷ mol m⁻³ s⁻¹): 0.011045451186
Surface CO₂ flux (x10⁻⁷ mol m⁻³ s⁻¹): -4.246615629236
Iteration: 6600, time: 141 days
Surface DIC tendency (x10⁻⁷ mol m⁻³ s⁻¹): 4.777411576457
Surface ALK tendency (x10⁻⁷ mol m⁻³ s⁻¹): 0.010971878532
Surface CO₂ flux (x10⁻⁷ mol m⁻³ s⁻¹): -4.210129986179
Iteration: 6700, time: 145.167 days
Surface DIC tendency (x10⁻⁷ mol m⁻³ s⁻¹): 4.631539887746
Surface ALK tendency (x10⁻⁷ mol m⁻³ s⁻¹): 0.010898698108
Surface CO₂ flux (x10⁻⁷ mol m⁻³ s⁻¹): -4.174620346439
Iteration: 6800, time: 149.333 days
Surface DIC tendency (x10⁻⁷ mol m⁻³ s⁻¹): 4.493122503437
Surface ALK tendency (x10⁻⁷ mol m⁻³ s⁻¹): 0.010825918559
Surface CO₂ flux (x10⁻⁷ mol m⁻³ s⁻¹): -4.140038038801
Iteration: 6900, time: 153.500 days
Surface DIC tendency (x10⁻⁷ mol m⁻³ s⁻¹): 4.361610682106
Surface ALK tendency (x10⁻⁷ mol m⁻³ s⁻¹): 0.010753547275
Surface CO₂ flux (x10⁻⁷ mol m⁻³ s⁻¹): -4.106338294629
Iteration: 7000, time: 157.667 days
Surface DIC tendency (x10⁻⁷ mol m⁻³ s⁻¹): 4.236509515761
Surface ALK tendency (x10⁻⁷ mol m⁻³ s⁻¹): 0.010681590554
Surface CO₂ flux (x10⁻⁷ mol m⁻³ s⁻¹): -4.073479806001
Iteration: 7100, time: 161.833 days
Surface DIC tendency (x10⁻⁷ mol m⁻³ s⁻¹): 4.117371295183
Surface ALK tendency (x10⁻⁷ mol m⁻³ s⁻¹): 0.010610053736
Surface CO₂ flux (x10⁻⁷ mol m⁻³ s⁻¹): -4.041424347569
Iteration: 7200, time: 166 days
Surface DIC tendency (x10⁻⁷ mol m⁻³ s⁻¹): 4.003789856861
Surface ALK tendency (x10⁻⁷ mol m⁻³ s⁻¹): 0.010538941299
Surface CO₂ flux (x10⁻⁷ mol m⁻³ s⁻¹): -4.010136451146
Iteration: 7300, time: 170.167 days
Surface DIC tendency (x10⁻⁷ mol m⁻³ s⁻¹): 3.895395743029
Surface ALK tendency (x10⁻⁷ mol m⁻³ s⁻¹): 0.010468256972
Surface CO₂ flux (x10⁻⁷ mol m⁻³ s⁻¹): -3.979583124264
Iteration: 7400, time: 174.333 days
Surface DIC tendency (x10⁻⁷ mol m⁻³ s⁻¹): 3.791852038874
Surface ALK tendency (x10⁻⁷ mol m⁻³ s⁻¹): 0.010398003837
Surface CO₂ flux (x10⁻⁷ mol m⁻³ s⁻¹): -3.949733605566
Iteration: 7500, time: 178.500 days
Surface DIC tendency (x10⁻⁷ mol m⁻³ s⁻¹): 3.692850776888
Surface ALK tendency (x10⁻⁷ mol m⁻³ s⁻¹): 0.010328184369
Surface CO₂ flux (x10⁻⁷ mol m⁻³ s⁻¹): -3.920559151253
Iteration: 7600, time: 182.667 days
Surface DIC tendency (x10⁻⁷ mol m⁻³ s⁻¹): 3.598109818524
Surface ALK tendency (x10⁻⁷ mol m⁻³ s⁻¹): 0.010258800528
Surface CO₂ flux (x10⁻⁷ mol m⁻³ s⁻¹): -3.892032847853
Iteration: 7700, time: 186.833 days
Surface DIC tendency (x10⁻⁷ mol m⁻³ s⁻¹): 3.507370139518
Surface ALK tendency (x10⁻⁷ mol m⁻³ s⁻¹): 0.010189853813
Surface CO₂ flux (x10⁻⁷ mol m⁻³ s⁻¹): -3.864129447400
Iteration: 7800, time: 191 days
Surface DIC tendency (x10⁻⁷ mol m⁻³ s⁻¹): 3.420393458076
Surface ALK tendency (x10⁻⁷ mol m⁻³ s⁻¹): 0.010121345289
Surface CO₂ flux (x10⁻⁷ mol m⁻³ s⁻¹): -3.836825221787
Iteration: 7900, time: 195.167 days
Surface DIC tendency (x10⁻⁷ mol m⁻³ s⁻¹): 3.336960155558
Surface ALK tendency (x10⁻⁷ mol m⁻³ s⁻¹): 0.010053275650
Surface CO₂ flux (x10⁻⁷ mol m⁻³ s⁻¹): -3.810097833598
Iteration: 8000, time: 199.333 days
Surface DIC tendency (x10⁻⁷ mol m⁻³ s⁻¹): 3.256867447671
Surface ALK tendency (x10⁻⁷ mol m⁻³ s⁻¹): 0.009985645281
Surface CO₂ flux (x10⁻⁷ mol m⁻³ s⁻¹): -3.783926221162
Iteration: 8100, time: 203.500 days
Surface DIC tendency (x10⁻⁷ mol m⁻³ s⁻¹): 3.179927771067
Surface ALK tendency (x10⁻⁷ mol m⁻³ s⁻¹): 0.009918454252
Surface CO₂ flux (x10⁻⁷ mol m⁻³ s⁻¹): -3.758290495934
Iteration: 8200, time: 207.667 days
Surface DIC tendency (x10⁻⁷ mol m⁻³ s⁻¹): 3.105967355722
Surface ALK tendency (x10⁻⁷ mol m⁻³ s⁻¹): 0.009851702356
Surface CO₂ flux (x10⁻⁷ mol m⁻³ s⁻¹): -3.733171850593
Iteration: 8300, time: 211.833 days
Surface DIC tendency (x10⁻⁷ mol m⁻³ s⁻¹): 3.034824958315
Surface ALK tendency (x10⁻⁷ mol m⁻³ s⁻¹): 0.009785389162
Surface CO₂ flux (x10⁻⁷ mol m⁻³ s⁻¹): -3.708552476495
Iteration: 8400, time: 216 days
Surface DIC tendency (x10⁻⁷ mol m⁻³ s⁻¹): 2.966350735312
Surface ALK tendency (x10⁻⁷ mol m⁻³ s⁻¹): 0.009719514006
Surface CO₂ flux (x10⁻⁷ mol m⁻³ s⁻¹): -3.684415489330
Iteration: 8500, time: 220.167 days
Surface DIC tendency (x10⁻⁷ mol m⁻³ s⁻¹): 2.900405237886
Surface ALK tendency (x10⁻⁷ mol m⁻³ s⁻¹): 0.009654076037
Surface CO₂ flux (x10⁻⁷ mol m⁻³ s⁻¹): -3.660744861972
Iteration: 8600, time: 224.333 days
Surface DIC tendency (x10⁻⁷ mol m⁻³ s⁻¹): 2.836858513320
Surface ALK tendency (x10⁻⁷ mol m⁻³ s⁻¹): 0.009589074233
Surface CO₂ flux (x10⁻⁷ mol m⁻³ s⁻¹): -3.637525363690
Iteration: 8700, time: 228.500 days
Surface DIC tendency (x10⁻⁷ mol m⁻³ s⁻¹): 2.775589299684
Surface ALK tendency (x10⁻⁷ mol m⁻³ s⁻¹): 0.009524507417
Surface CO₂ flux (x10⁻⁷ mol m⁻³ s⁻¹): -3.614742504971
Iteration: 8800, time: 232.667 days
Surface DIC tendency (x10⁻⁷ mol m⁻³ s⁻¹): 2.716484302533
Surface ALK tendency (x10⁻⁷ mol m⁻³ s⁻¹): 0.009460374235
Surface CO₂ flux (x10⁻⁷ mol m⁻³ s⁻¹): -3.592382487327
Iteration: 8900, time: 236.833 days
Surface DIC tendency (x10⁻⁷ mol m⁻³ s⁻¹): 2.659437543989
Surface ALK tendency (x10⁻⁷ mol m⁻³ s⁻¹): 0.009396673248
Surface CO₂ flux (x10⁻⁷ mol m⁻³ s⁻¹): -3.570432157526
Iteration: 9000, time: 241 days
Surface DIC tendency (x10⁻⁷ mol m⁻³ s⁻¹): 2.604349775491
Surface ALK tendency (x10⁻⁷ mol m⁻³ s⁻¹): 0.009333402873
Surface CO₂ flux (x10⁻⁷ mol m⁻³ s⁻¹): -3.548878965779
Iteration: 9100, time: 245.167 days
Surface DIC tendency (x10⁻⁷ mol m⁻³ s⁻¹): 2.551127947275
Surface ALK tendency (x10⁻⁷ mol m⁻³ s⁻¹): 0.009270561439
Surface CO₂ flux (x10⁻⁷ mol m⁻³ s⁻¹): -3.527710927454
Iteration: 9200, time: 249.333 days
Surface DIC tendency (x10⁻⁷ mol m⁻³ s⁻¹): 2.499684727939
Surface ALK tendency (x10⁻⁷ mol m⁻³ s⁻¹): 0.009208147179
Surface CO₂ flux (x10⁻⁷ mol m⁻³ s⁻¹): -3.506916587961
Iteration: 9300, time: 253.500 days
Surface DIC tendency (x10⁻⁷ mol m⁻³ s⁻¹): 2.449938068718
Surface ALK tendency (x10⁻⁷ mol m⁻³ s⁻¹): 0.009146158217
Surface CO₂ flux (x10⁻⁷ mol m⁻³ s⁻¹): -3.486484990465
Iteration: 9400, time: 257.667 days
Surface DIC tendency (x10⁻⁷ mol m⁻³ s⁻¹): 2.401810807579
Surface ALK tendency (x10⁻⁷ mol m⁻³ s⁻¹): 0.009084592646
Surface CO₂ flux (x10⁻⁷ mol m⁻³ s⁻¹): -3.466405646175
Iteration: 9500, time: 261.833 days
Surface DIC tendency (x10⁻⁷ mol m⁻³ s⁻¹): 2.355230308854
Surface ALK tendency (x10⁻⁷ mol m⁻³ s⁻¹): 0.009023448438
Surface CO₂ flux (x10⁻⁷ mol m⁻³ s⁻¹): -3.446668506932
Iteration: 9600, time: 266 days
Surface DIC tendency (x10⁻⁷ mol m⁻³ s⁻¹): 2.310128134745
Surface ALK tendency (x10⁻⁷ mol m⁻³ s⁻¹): 0.008962723540
Surface CO₂ flux (x10⁻⁷ mol m⁻³ s⁻¹): -3.427263939885
Iteration: 9700, time: 270.167 days
Surface DIC tendency (x10⁻⁷ mol m⁻³ s⁻¹): 2.266439745397
Surface ALK tendency (x10⁻⁷ mol m⁻³ s⁻¹): 0.008902415840
Surface CO₂ flux (x10⁻⁷ mol m⁻³ s⁻¹): -3.408182704063
Iteration: 9800, time: 274.333 days
Surface DIC tendency (x10⁻⁷ mol m⁻³ s⁻¹): 2.224104224577
Surface ALK tendency (x10⁻⁷ mol m⁻³ s⁻¹): 0.008842523152
Surface CO₂ flux (x10⁻⁷ mol m⁻³ s⁻¹): -3.389415928654
Iteration: 9900, time: 278.500 days
Surface DIC tendency (x10⁻⁷ mol m⁻³ s⁻¹): 2.183064028568
Surface ALK tendency (x10⁻⁷ mol m⁻³ s⁻¹): 0.008783043280
Surface CO₂ flux (x10⁻⁷ mol m⁻³ s⁻¹): -3.370955092861
Iteration: 10000, time: 282.667 days
Surface DIC tendency (x10⁻⁷ mol m⁻³ s⁻¹): 2.143264755788
Surface ALK tendency (x10⁻⁷ mol m⁻³ s⁻¹): 0.008723973953
Surface CO₂ flux (x10⁻⁷ mol m⁻³ s⁻¹): -3.352792007167
Iteration: 10100, time: 286.833 days
Surface DIC tendency (x10⁻⁷ mol m⁻³ s⁻¹): 2.104654935279
Surface ALK tendency (x10⁻⁷ mol m⁻³ s⁻¹): 0.008665312905
Surface CO₂ flux (x10⁻⁷ mol m⁻³ s⁻¹): -3.334918795899
Iteration: 10200, time: 291 days
Surface DIC tendency (x10⁻⁷ mol m⁻³ s⁻¹): 2.067185832234
Surface ALK tendency (x10⁻⁷ mol m⁻³ s⁻¹): 0.008607057797
Surface CO₂ flux (x10⁻⁷ mol m⁻³ s⁻¹): -3.317327880992
Iteration: 10300, time: 295.167 days
Surface DIC tendency (x10⁻⁷ mol m⁻³ s⁻¹): 2.030811268896
Surface ALK tendency (x10⁻⁷ mol m⁻³ s⁻¹): 0.008549206300
Surface CO₂ flux (x10⁻⁷ mol m⁻³ s⁻¹): -3.300011966821
Iteration: 10400, time: 299.333 days
Surface DIC tendency (x10⁻⁷ mol m⁻³ s⁻¹): 1.995487459553
Surface ALK tendency (x10⁻⁷ mol m⁻³ s⁻¹): 0.008491756044
Surface CO₂ flux (x10⁻⁷ mol m⁻³ s⁻¹): -3.282964026050
Iteration: 10500, time: 303.500 days
Surface DIC tendency (x10⁻⁷ mol m⁻³ s⁻¹): 1.961172858132
Surface ALK tendency (x10⁻⁷ mol m⁻³ s⁻¹): 0.008434704620
Surface CO₂ flux (x10⁻⁷ mol m⁻³ s⁻¹): -3.266177286379
Iteration: 10600, time: 307.667 days
Surface DIC tendency (x10⁻⁷ mol m⁻³ s⁻¹): 1.927828017503
Surface ALK tendency (x10⁻⁷ mol m⁻³ s⁻¹): 0.008378049643
Surface CO₂ flux (x10⁻⁷ mol m⁻³ s⁻¹): -3.249645218148
Iteration: 10700, time: 311.833 days
Surface DIC tendency (x10⁻⁷ mol m⁻³ s⁻¹): 1.895415459250
Surface ALK tendency (x10⁻⁷ mol m⁻³ s⁻¹): 0.008321788678
Surface CO₂ flux (x10⁻⁷ mol m⁻³ s⁻¹): -3.233361522703
Iteration: 10800, time: 316 days
Surface DIC tendency (x10⁻⁷ mol m⁻³ s⁻¹): 1.863899553103
Surface ALK tendency (x10⁻⁷ mol m⁻³ s⁻¹): 0.008265919289
Surface CO₂ flux (x10⁻⁷ mol m⁻³ s⁻¹): -3.217320121495
Iteration: 10900, time: 320.167 days
Surface DIC tendency (x10⁻⁷ mol m⁻³ s⁻¹): 1.833246405202
Surface ALK tendency (x10⁻⁷ mol m⁻³ s⁻¹): 0.008210439031
Surface CO₂ flux (x10⁻⁷ mol m⁻³ s⁻¹): -3.201515145826
Iteration: 11000, time: 324.333 days
Surface DIC tendency (x10⁻⁷ mol m⁻³ s⁻¹): 1.803423754353
Surface ALK tendency (x10⁻⁷ mol m⁻³ s⁻¹): 0.008155345452
Surface CO₂ flux (x10⁻⁷ mol m⁻³ s⁻¹): -3.185940927215
Iteration: 11100, time: 328.500 days
Surface DIC tendency (x10⁻⁷ mol m⁻³ s⁻¹): 1.774400875723
Surface ALK tendency (x10⁻⁷ mol m⁻³ s⁻¹): 0.008100636103
Surface CO₂ flux (x10⁻⁷ mol m⁻³ s⁻¹): -3.170591988327
Iteration: 11200, time: 332.667 days
Surface DIC tendency (x10⁻⁷ mol m⁻³ s⁻¹): 1.746148491281
Surface ALK tendency (x10⁻⁷ mol m⁻³ s⁻¹): 0.008046308487
Surface CO₂ flux (x10⁻⁷ mol m⁻³ s⁻¹): -3.155463034431
Iteration: 11300, time: 336.833 days
Surface DIC tendency (x10⁻⁷ mol m⁻³ s⁻¹): 1.718638686432
Surface ALK tendency (x10⁻⁷ mol m⁻³ s⁻¹): 0.007992360153
Surface CO₂ flux (x10⁻⁷ mol m⁻³ s⁻¹): -3.140548945343
Iteration: 11400, time: 341 days
Surface DIC tendency (x10⁻⁷ mol m⁻³ s⁻¹): 1.691844832405
Surface ALK tendency (x10⁻⁷ mol m⁻³ s⁻¹): 0.007938788633
Surface CO₂ flux (x10⁻⁷ mol m⁻³ s⁻¹): -3.125844767821
Iteration: 11500, time: 345.167 days
Surface DIC tendency (x10⁻⁷ mol m⁻³ s⁻¹): 1.665741513862
Surface ALK tendency (x10⁻⁷ mol m⁻³ s⁻¹): 0.007885591442
Surface CO₂ flux (x10⁻⁷ mol m⁻³ s⁻¹): -3.111345708394
Iteration: 11600, time: 349.333 days
Surface DIC tendency (x10⁻⁷ mol m⁻³ s⁻¹): 1.640304461345
Surface ALK tendency (x10⁻⁷ mol m⁻³ s⁻¹): 0.007832766126
Surface CO₂ flux (x10⁻⁷ mol m⁻³ s⁻¹): -3.097047126560
Iteration: 11700, time: 353.500 days
Surface DIC tendency (x10⁻⁷ mol m⁻³ s⁻¹): 1.615510488256
Surface ALK tendency (x10⁻⁷ mol m⁻³ s⁻¹): 0.007780310201
Surface CO₂ flux (x10⁻⁷ mol m⁻³ s⁻¹): -3.082944528381
Iteration: 11800, time: 357.667 days
Surface DIC tendency (x10⁻⁷ mol m⁻³ s⁻¹): 1.591337431863
Surface ALK tendency (x10⁻⁷ mol m⁻³ s⁻¹): 0.007728221209
Surface CO₂ flux (x10⁻⁷ mol m⁻³ s⁻¹): -3.069033560393
Iteration: 11900, time: 361.833 days
Surface DIC tendency (x10⁻⁷ mol m⁻³ s⁻¹): 1.567764098209
Surface ALK tendency (x10⁻⁷ mol m⁻³ s⁻¹): 0.007676496669
Surface CO₂ flux (x10⁻⁷ mol m⁻³ s⁻¹): -3.055310003855
<span class="sgr36"><span class="sgr1">[ Info: </span></span>Simulation is stopping after running for 48.250 seconds.
<span class="sgr36"><span class="sgr1">[ Info: </span></span>Simulation time 365.250 days equals or exceeds stop time 365.250 days.</code></pre><h2 id="Visualization"><a class="docs-heading-anchor" href="#Visualization">Visualization</a><a id="Visualization-1"></a><a class="docs-heading-anchor-permalink" href="#Visualization" title="Permalink"></a></h2><p>All that&#39;s left is to visualize the results.</p><pre><code class="language-julia hljs">Tt   = FieldTimeSeries(filename, &quot;T&quot;)
St   = FieldTimeSeries(filename, &quot;S&quot;)
DICt = FieldTimeSeries(filename, &quot;DIC&quot;)
Alkt = FieldTimeSeries(filename, &quot;ALK&quot;)
PO₄t = FieldTimeSeries(filename, &quot;PO₄&quot;)
NO₃t = FieldTimeSeries(filename, &quot;NO₃&quot;)
DOPt = FieldTimeSeries(filename, &quot;DOP&quot;)
POPt = FieldTimeSeries(filename, &quot;POP&quot;)
Fet  = FieldTimeSeries(filename, &quot;Fe&quot;)
CO₂t = FieldTimeSeries(filename_diags, &quot;co₂_flux&quot;)
apCO₂t = FieldTimeSeries(filename_diags, &quot;atmos_pCO₂&quot;)
opCO₂t = FieldTimeSeries(filename_diags, &quot;ocean_pCO₂&quot;)

tt = Tt.times
nt = length(tt)
z  = znodes(Tt)

CO₂_flux_time_series   = [CO₂t[1, 1, 1, i] for i in 1:nt]
pCO₂_ocean_time_series = [opCO₂t[1, 1, 1, i] for i in 1:nt]
pCO₂_atmos_time_series = [apCO₂t[1, 1, 1, i] for i in 1:nt]

fig = Figure(size=(1200, 1200))
n = Observable(1)

axb = Axis(
    fig[1:4, 1],
    xlabel=&quot;Temperature (K)&quot;,
    ylabel=&quot;z (m)&quot;,
    )
axC = Axis(
    fig[1:4, 2],
    xlabel=&quot;DIC/ALK Concentration (mol m⁻³)&quot;,
    )
axN = Axis(
    fig[1:4, 3],
    xlabel=&quot;Inorganic Nutrient concentration (mol m⁻³)&quot;,
    )
axD = Axis(
    fig[1:4, 4],
    xlabel=&quot;Organic Nutrient concentration (mol m⁻³)&quot;,
    )
axF = Axis(
    fig[5:6, 1:4],
    ylabel=&quot;Air-sea CO₂ fluxes (x1e7 mol m⁻² s⁻¹)&quot;,
    xlabel=&quot;Time (days)&quot;,
    )
axP = Axis(
    fig[5:6, 1:4],
    ylabel=&quot;pCO₂ (μatm)&quot;,
    yticklabelcolor = :red,
    yaxisposition = :right,
    )

xlims!(axb, 7, 21)
xlims!(axC, 1.8, 2.6)
xlims!(axN, -5, 75)
xlims!(axD, -50, 250)
xlims!(axF, -1, 1+simulation.stop_time/days)
xlims!(axP, -1, 1+simulation.stop_time/days)
ylims!(axF, -8, 2)
ylims!(axP, 0, 500)

#slider = Slider(fig[2, 1:4], range=1:nt, startvalue=1)
#n = slider.value

title = @lift @sprintf(
    &quot;Convecting nutrients at t = %d days&quot;, tt[$n] / days
    )
Label(fig[0, 1:4], title)

Tn = @lift interior(Tt[$n], 1, 1, :)
DICn = @lift interior(DICt[$n], 1, 1, :)
Alkn = @lift interior(Alkt[$n], 1, 1, :)
PO₄n = @lift interior(PO₄t[$n], 1, 1, :) * 16 * 1e3
NO₃n = @lift interior(NO₃t[$n], 1, 1, :) * 1e3
DOPn = @lift interior(DOPt[$n], 1, 1, :) * 1e6
POPn = @lift interior(POPt[$n], 1, 1, :) * 1e6
Fen  = @lift interior(Fet[$n],  1, 1, :) * 1e7
CO₂_flux_points = Observable(
    Point2f[(tt[1],
    (CO₂_flux_time_series[1] * 1e7))]
    )
pCO₂_ocean_points = Observable(
    Point2f[(tt[1],
    (pCO₂_ocean_time_series[1] * 1e6))]
    )
pCO₂_atmos_points = Observable(
    Point2f[(tt[1],
    (pCO₂_atmos_time_series[1] * 1e6))]
    )

lines!(axb, Tn,   z)
lines!(axC, DICn, z, label=&quot;DIC&quot;)
lines!(axC, Alkn, z, label=&quot;ALK&quot;)
lines!(axN, PO₄n, z, label=&quot;Phosphate (x16e-3)&quot;)
lines!(axN, NO₃n, z, label=&quot;Nitrate (x1e-3)&quot;)
lines!(axN, Fen,  z, label=&quot;Iron (x1e-7)&quot;)
lines!(axD, DOPn, z, label=&quot;DOP (x1e-6)&quot;)
lines!(axD, POPn, z, label=&quot;POP (x1e-6)&quot;)

scatter!(axP,
    pCO₂_ocean_points;
    marker = :circle,
    markersize = 4,
    color = :blue,
    label=&quot;ocean pCO₂&quot;,
    )
scatter!(axP,
    pCO₂_atmos_points;
    marker = :circle,
    markersize = 4,
    color = :red,
    label=&quot;atmos pCO₂&quot;,
    )
scatter!(axF,
    CO₂_flux_points;
    marker = :circle,
    markersize = 4,
    color = :black,
    )

axislegend(axC,position=:cb)
axislegend(axN,position=:cb)
axislegend(axD,position=:cb)
axislegend(axP,position=:rt)

record(fig,
    &quot;single_column_carbon_alkalinity_nutrients.mp4&quot;,
    1:nt,
    framerate=64
    ) do nn
    n[] = nn
    new_point = Point2(
        tt[nn] / days,
        (CO₂_flux_time_series[nn] * 1e7),
        )
    CO₂_flux_points[]  = push!(
        CO₂_flux_points[],
        new_point,
        )

    new_point = Point2(
        tt[nn] / days,
        (pCO₂_ocean_time_series[nn] * 1e6),
        )
    pCO₂_ocean_points[]  = push!(
        pCO₂_ocean_points[],
        new_point,
        )

    new_point = Point2(
        tt[nn] / days,
        (pCO₂_atmos_time_series[nn] * 1e6),
        )
    pCO₂_atmos_points[]  = push!(
        pCO₂_atmos_points[],
        new_point,
        )
end
fig</code></pre><img src="4e2d103d.png" alt="Example block output"/><p><video src="../single_column_carbon_alkalinity_nutrients.mp4" controls="true" title><a href="../single_column_carbon_alkalinity_nutrients.mp4"></a></video></p><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../single_column_nutrients_plankton_bacteria_detritus/">« Single column nutrients, plankton, bacteria, detritus</a><a class="docs-footer-nextpage" href="../soda_outgassing/">Soda outgassing »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.8.0 on <span class="colophon-date" title="Tuesday 4 February 2025 20:44">Tuesday 4 February 2025</span>. Using Julia version 1.10.8.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
